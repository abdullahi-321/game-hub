<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Madimi+One&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="tictactoe.css" />
    <link rel="shortcut icon" href="assets/tictactoe.png" type="image/x-icon" />
    <title>Tic Tac Toe</title>
  </head>
  <body>
    <nav>
      <a href="/index.html"><i class="bx bx-arrow-back"></i></a>
      <h1>Tic Tac Toe</h1>
      <button>Reset Score</button>
    </nav>
    <aside class="scores">
      <h3 id="player1Score">Player 1:</h3>
      <h3 id="player2Score">Player 2:</h3>
    </aside>
    <span>
      <label class="playerEl">Player 1's Turn</label>
      <main>
        <div class="div1"></div>
        <div class="div2"></div>
        <div class="div3"></div>
        <div class="div4"></div>
        <div class="div5"></div>
        <div class="div6"></div>
        <div class="div7"></div>
        <div class="div8"></div>
        <div class="div9"></div>
      </main>
    </span>
    <script>
      let player1Turn = true;
      let player2Turn = false;
      let player1Score = localStorage.getItem("player1Score") || 0;
      let player2Score = localStorage.getItem("player2Score") || 0;
      player1Score = Number(player1Score);
      player2Score = Number(player2Score);
      const player1El = document.getElementById("player1Score");
      const player2El = document.getElementById("player2Score");
      player1El.innerHTML = "Player 1: " + player1Score;
      player2El.innerHTML = "Player 2: " + player2Score;
      const X = "X";
      const O = "O";
      const span = document.querySelector("span");
      const divs = document.querySelectorAll("div");
      const playerEl = document.querySelector(".playerEl");

      const div1 = document.querySelector(".div1"),
        div2 = document.querySelector(".div2"),
        div3 = document.querySelector(".div3"),
        div4 = document.querySelector(".div4"),
        div5 = document.querySelector(".div5"),
        div6 = document.querySelector(".div6"),
        div7 = document.querySelector(".div7"),
        div8 = document.querySelector(".div8"),
        div9 = document.querySelector(".div9");

      divs.forEach((div) => {
        div.addEventListener("mousedown", () => {
          if (div.innerHTML == "") {
            if (player1Turn) {
              div.innerHTML = X;
            } else if (player2Turn) {
              div.innerHTML = O;
            }

            const T1 = div1.innerHTML == X,
              T2 = div2.innerHTML == X,
              T3 = div3.innerHTML == X,
              T4 = div4.innerHTML == X,
              T5 = div5.innerHTML == X,
              T6 = div6.innerHTML == X,
              T7 = div7.innerHTML == X,
              T8 = div8.innerHTML == X,
              T9 = div9.innerHTML == X;
            const F1 = div1.innerHTML == O,
              F2 = div2.innerHTML == O,
              F3 = div3.innerHTML == O,
              F4 = div4.innerHTML == O,
              F5 = div5.innerHTML == O,
              F6 = div6.innerHTML == O,
              F7 = div7.innerHTML == O,
              F8 = div8.innerHTML == O,
              F9 = div9.innerHTML == O;

            if (
              (T1 && T2 && T3) ||
              (T4 && T5 && T6) ||
              (T7 && T8 && T9) ||
              (T1 && T4 && T7) ||
              (T2 && T5 && T8) ||
              (T3 && T6 && T9) ||
              (T1 && T5 && T9) ||
              (T3 && T5 && T7)
            ) {
              localStorage.setItem("player1Score", player1Score + 1);
              player1Score = localStorage.getItem("player1Score") || 0;
              span.innerHTML = `<p>Player 1 wins</p>
        <a class="a" href="tictactoe.html">New Game</a>`;
            } else if (
              (F1 && F2 && F3) ||
              (F4 && F5 && F6) ||
              (F7 && F8 && F9) ||
              (F1 && F4 && F7) ||
              (F2 && F5 && F8) ||
              (F3 && F6 && F9) ||
              (F1 && F5 && F9) ||
              (F3 && F5 && F7)
            ) {
              localStorage.setItem("player2Score", player2Score + 1);
              player2Score = localStorage.getItem("player2Score") || 0;
              span.innerHTML = `<p>Player 2 wins</p>
              <a class="a" href="tictactoe.html">New Game</a>`;
            }

            player1Turn = !player1Turn;
            player2Turn = !player2Turn;

            playerEl.innerHTML = player1Turn
              ? "Player 1's Turn"
              : "Player 2's Turn";
          }
          player1El.innerHTML = "Player 1: " + player1Score;
          player2El.innerHTML = "Player 2: " + player2Score;
        });
      });

      document.querySelector("button").onclick = () => {
        localStorage.setItem("player1Score", 0);
        localStorage.setItem("player2Score", 0);
        player1Score = localStorage.getItem("player1Score") || 0;
        player2Score = localStorage.getItem("player2Score") || 0;
        player1El.innerHTML = "Player 1: " + player1Score;
        player2El.innerHTML = "Player 2: " + player2Score;
      };
    </script>
  </body>
</html>
